---
import { getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';

const allBooks = await getCollection('books', ({ data }) => {
  return import.meta.env.PROD ? !data.draft : true;
});

const sortedBooks = allBooks.sort((a, b) => 
  a.data.title.localeCompare(b.data.title)
);
---

<BaseLayout 
  title="Books - Oliver Gilan" 
  description="My reading list and book thoughts"
  currentPath="/books"
>
  <div>
    <h1 class="text-4xl font-bold mb-8">Books</h1>
    <div class="grid gap-6 md:grid-cols-2">
      {sortedBooks.map((book) => (
        <article class="border border-gray-200 rounded-lg p-6 hover:border-blue-500 transition-colors">
          <a href={`/books/${book.slug}`} class="group">
            <h2 class="text-xl font-bold text-gray-900 group-hover:text-blue-600 transition-colors mb-2">
              {book.data.title}
            </h2>
          </a>
          {book.data.author && (
            <p class="text-sm text-gray-600 mb-2">by {book.data.author}</p>
          )}
          {book.data.genre && (
            <span class="inline-block text-xs bg-gray-100 text-gray-700 px-2 py-1 rounded">
              {book.data.genre}
            </span>
          )}
        </article>
      ))}
    </div>
  </div>
</BaseLayout>
